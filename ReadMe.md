# 简介

## **本项目已经永久停止更新**
这是一个Windows编程的项目……
一个最快能在10分钟内快速刷完学习大厅所有题目的工具，无需手动填写任何答案，只需要点“下一步”、“完成”即可

随便新建一个Solution，导入Pxml.vcproj即可。Pxml.cpp是入口点,主体部分都在这个文件里。其他很多文件是用到的库
关于编译问题详见后面的说明。~~正在完善中……~~

### 优点：
- 只需要点击下一步、完成即可，不需要手动填写；
- 可以使用快速模式，只需最多几分钟，快速连刷10+套题；
- 具备混淆能力，自动随机化处理答案，分数控制在70到90左右；
- 安全性，遇到大部分错误立即终止考试客户端；
- 可以不使用密码帮助他人，（仍需要班号，这个可以从南开-班号.txt中找）

### 缺点：

0. 重要问题：由于快速模式POST提交比较频繁，超过一定界限服务器就会拒掉以后的请求，（不知道是不是“网站安全狗”的原因）即使用正常方式也会提示交卷失败；一天之后才能自动恢复，所以本程序设定为使用命令行参数/q才能使用快速模式，其他情况下只刷一套；
1. 客户端程序错误的判定问题：需要增加一个线程，为了避免问题我打算搞清多线程基本原理再加入这一部分。目前遇到这种情况程序会继续等待。
2. 输入信息的简化：目前输入信息的方式比较繁琐。李旭晟的程序之所以不涉及这个问题是因为操纵的paper.xml，恰好不需要任何个人信息；我为了能直接操纵提交结果，必须输入这些信息，而我希望尽量不要给用户添麻烦。
	理想的方式是，仿照李旭晟的程序，当用户打开学习大厅，点击开始测试调出TestClient之后，直接读取TestClient的命令行，这样既方便了用户，也省去了构造命令行的麻烦，甚至不再需要自主学习大厅安装到那个特定目录D:\Nptest下，我的程序也可以在任意目录运行，一举N得。
	但是问题在于Windows不提供读取远程进程命令行的API，只有读取本进程命令行的API；要想实现这一功能，有两种方案：
	a) DLL注入到TestClient.exe里，再用API读取  
	b) 找到进程以后直接ReadProcessMemory ， 比较暴力，不知道在不同操作系统上能不能行得通
    我打算先查一些Windows编程的资料，琢磨明白原理，再来解决这个问题。按网上别人写的例子来抄改也不是不能做，不过我需要稳定可控的代码。

### 关于编译问题：
在VS2008下编译通过，还没有测试其他机器执行时是否需要运行库……（等考完）
里面用到了CRT函数，非VC可能编译不过，这个放假以后调整
另外还有一个编译环境的问题，这个经常在Windows编程中遇到，就是查看一下Project属性有没有预定义使用UNICODE字符集（2008默认是UNICODE)，如果没有就在文件里define _UNICODE 和define UNICODE
原因：使用的Windows API版本不同，我这里大部分都处理好了，个别地方可能还会出问题
暂时没了

### 下面要做的：
- 去掉多余的注释
- 尽可能改写CRT函数
- 修改main函数的实现方法
- 提取宽窄字符数据类型转换函数；
- 统一API函数版本

- 优化数据类型
- 优化代码结构

- 反复测试
- 简化这个说明=_=

- 如果有可能的话，引入try{}catch
